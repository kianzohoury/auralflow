Search.setIndex({"docnames": ["api", "auralflow", "auralflow.customs", "auralflow.customs.init_model", "auralflow.customs.setup_model", "auralflow.datasets", "auralflow.datasets.AudioDataset", "auralflow.datasets.AudioFolder", "auralflow.datasets.create_audio_dataset", "auralflow.datasets.create_audio_folder", "auralflow.datasets.load_stems", "auralflow.datasets.verify_dataset", "auralflow.losses", "auralflow.losses.ComponentLoss", "auralflow.losses.KLDivergenceLoss", "auralflow.losses.SISDRLoss", "auralflow.losses.component_loss", "auralflow.losses.kl_div_loss", "auralflow.losses.si_sdr_loss", "auralflow.model.SeparationModel", "auralflow.models", "auralflow.models.SpectrogramMaskModel", "auralflow.models.SpectrogramNetLSTM", "auralflow.models.SpectrogramNetSimple", "auralflow.models.SpectrogramNetVAE", "auralflow.trainer", "auralflow.trainer.callbacks", "auralflow.trainer.run_training", "auralflow.trainer.run_validation", "auralflow.transforms", "auralflow.transforms.AudioTransform", "auralflow.transforms.trim_audio", "auralflow.utils", "auralflow.visualizer", "auralflow.visualizer.spec_show_diff", "auralflow.visualizer.waveform_show_diff", "contents", "generated/auralflow.customs", "generated/auralflow.datasets", "generated/auralflow.losses", "generated/auralflow.models", "generated/auralflow.trainer", "generated/auralflow.transforms", "generated/auralflow.utils", "generated/auralflow.visualizer", "index", "installation", "modules", "notes", "params", "theory", "tutorial", "usage"], "filenames": ["api.rst", "auralflow.rst", "auralflow.customs.rst", "auralflow.customs.init_model.rst", "auralflow.customs.setup_model.rst", "auralflow.datasets.rst", "auralflow.datasets.AudioDataset.rst", "auralflow.datasets.AudioFolder.rst", "auralflow.datasets.create_audio_dataset.rst", "auralflow.datasets.create_audio_folder.rst", "auralflow.datasets.load_stems.rst", "auralflow.datasets.verify_dataset.rst", "auralflow.losses.rst", "auralflow.losses.ComponentLoss.rst", "auralflow.losses.KLDivergenceLoss.rst", "auralflow.losses.SISDRLoss.rst", "auralflow.losses.component_loss.rst", "auralflow.losses.kl_div_loss.rst", "auralflow.losses.si_sdr_loss.rst", "auralflow.model.SeparationModel.rst", "auralflow.models.rst", "auralflow.models.SpectrogramMaskModel.rst", "auralflow.models.SpectrogramNetLSTM.rst", "auralflow.models.SpectrogramNetSimple.rst", "auralflow.models.SpectrogramNetVAE.rst", "auralflow.trainer.rst", "auralflow.trainer.callbacks.rst", "auralflow.trainer.run_training.rst", "auralflow.trainer.run_validation.rst", "auralflow.transforms.rst", "auralflow.transforms.AudioTransform.rst", "auralflow.transforms.trim_audio.rst", "auralflow.utils.rst", "auralflow.visualizer.rst", "auralflow.visualizer.spec_show_diff.rst", "auralflow.visualizer.waveform_show_diff.rst", "contents.rst", "generated/auralflow.customs.rst", "generated/auralflow.datasets.rst", "generated/auralflow.losses.rst", "generated/auralflow.models.rst", "generated/auralflow.trainer.rst", "generated/auralflow.transforms.rst", "generated/auralflow.utils.rst", "generated/auralflow.visualizer.rst", "index.rst", "installation.rst", "modules.rst", "notes.rst", "params.rst", "theory.rst", "tutorial.rst", "usage.rst"], "titles": ["Python API", "auralflow package", "auralflow.customs", "auralflow.customs.init_model", "auralflow.customs.setup_model", "auralflow.datasets", "auralflow.datasets.AudioDataset", "auralflow.datasets.AudioFolder", "auralflow.datasets.create_audio_dataset", "auralflow.datasets.create_audio_folder", "auralflow.datasets.load_stems", "auralflow.datasets.verify_dataset", "auralflow.losses", "auralflow.losses.ComponentLoss", "auralflow.losses.KLDivergenceLoss", "auralflow.losses.SISDRLoss", "auralflow.losses.component_loss", "auralflow.losses.kl_div_loss", "auralflow.losses.si_sdr_loss", "auralflow.models.SeparationModel", "auralflow.models", "auralflow.models.SpectrogramMaskModel", "auralflow.models.SpectrogramNetLSTM", "auralflow.models.SpectrogramNetSimple", "auralflow.models.SpectrogramNetVAE", "auralflow.trainer", "auralflow.trainer.callbacks", "auralflow.trainer.run_training", "auralflow.trainer.run_validation", "auralflow.transforms", "auralflow.transforms.AudioTransform", "auralflow.transforms.trim_audio", "auralflow.utils", "auralflow.visualizer", "auralflow.visualizer.spec_show_diff", "auralflow.visualizer.waveform_show_diff", "&lt;no title&gt;", "auralflow.customs", "auralflow.datasets", "auralflow.losses", "auralflow.models", "auralflow.trainer", "auralflow.transforms", "auralflow.utils", "auralflow.visualizer", "Auralflow Documentation", "Installation", "auralflow", "Notes", "Parameters", "A Shallow Dive into Theory", "Tutorial", "Basic Usage"], "terms": {"separate_audio": [1, 52], "model": [1, 2, 3, 4, 12, 13, 14, 15, 17, 25, 27, 28, 32, 33, 36, 37, 45, 50], "filenam": [1, 52], "sr": [1, 12, 52], "44100": [1, 5, 6, 7, 8, 9, 10, 20, 21, 29, 30, 33, 52], "pad": [1, 29, 30], "200": 1, "durat": [1, 5, 6, 7, 8, 9, 10, 20, 21, 29, 30, 31, 52], "30": 1, "sourc": [1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 27, 28, 29, 30, 31, 32, 33, 34, 35, 45, 49, 50, 52], "singl": [1, 12, 15, 18, 51], "audio": [1, 5, 6, 7, 8, 9, 10, 11, 12, 15, 18, 19, 20, 21, 29, 30, 31, 33, 35, 36, 38, 45, 49, 51, 52], "track": [1, 5, 6, 7, 8, 9, 10, 11, 12, 15, 18, 19, 20, 45, 49, 50, 52], "return": [1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 12, 13, 16, 17, 18, 19, 20, 21, 29, 30, 31, 32, 33, 34, 35], "stem": [1, 5, 10], "tensor": [1, 6, 7, 12, 13, 14, 16, 17, 18, 19, 20, 21, 29, 30, 31, 33, 34, 35], "main": [1, 51], "config_filepath": 1, "save_filepath": [1, 32, 52], "max_track": 1, "20": [1, 29, 30], "resample_r": 1, "save": [1, 32, 33, 34, 35, 51, 52], "metric": [1, 12, 15, 18], "csv": [1, 51], "file": [1, 2, 3, 4, 5, 7, 8, 9, 10, 11, 32, 33, 38, 51], "run": [1, 12, 19, 20, 25, 27, 28, 33, 51], "script": [1, 45], "given": [1, 2, 3, 19, 20, 32, 50, 52], "configur": [1, 2, 3, 4, 32], "instanti": [2, 3, 4, 19, 20, 37], "setup": [2, 37], "train": [2, 4, 5, 7, 8, 9, 10, 11, 19, 20, 25, 27, 32, 33, 37, 45, 50, 51, 52], "evalu": [2, 12, 15, 18, 19, 20, 37, 45, 51], "test": [2, 5, 7, 8, 9, 11, 19, 20, 37, 51], "init_model": [2, 4], "creat": [2, 3, 4, 5, 6, 8, 9, 20, 23, 33, 34, 35, 46, 49, 51], "new": [2, 3, 4, 46, 51, 52], "separationmodel": [2, 3, 4, 12, 20, 21, 25, 27, 28, 32, 39], "instanc": [2, 3, 5, 7, 12, 19, 20], "read": [2, 3, 5, 8, 9, 10, 32], "data": [2, 3, 5, 6, 7, 10, 12, 17, 18, 19, 20, 21, 22, 23, 24, 29, 30, 31, 32, 49, 50], "build": [2, 3], "accord": [2, 3, 4], "spec": [2, 3], "possibl": [2, 3], "see": [2, 3, 51], "util": [2, 3, 4, 36, 45], "load_config": [2, 3, 4, 32], "load": [2, 3, 4, 5, 6, 7, 8, 9, 10, 32, 49, 51, 52], "paramet": [2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 25, 27, 28, 29, 30, 31, 32, 33, 34, 35, 50, 52], "dict": [2, 3, 32], "type": [2, 3, 4, 5, 6, 7, 8, 9, 10, 12, 13, 16, 17, 18, 19, 20, 29, 30, 31, 32, 33, 34, 35, 49, 50], "rais": [2, 3, 4, 5, 9, 10, 11, 32], "valueerror": [2, 3], "request": [2, 3, 20, 22], "base": [2, 3, 5, 6, 7, 12, 13, 14, 15, 20, 21, 22, 23, 24, 29, 30, 33, 45, 49], "doe": [2, 3, 20, 21, 32], "exist": [2, 3, 32, 50], "keyerror": [2, 3], "specifi": [2, 3, 51], "includ": [2, 3, 4, 5, 11, 45], "exampl": [2, 3, 4, 5, 8, 9, 12, 16, 17, 18, 33, 34, 35, 51], "import": [2, 3, 4, 5, 8, 9, 12, 16, 33, 34, 35, 52], "os": [2, 3, 4, 5, 8, 9, 52], "folder": [2, 3, 4, 5, 7, 9, 11, 51], "model_dir": [2, 3, 4], "getcwd": [2, 3, 4, 5, 8, 9, 52], "my_model": [2, 3, 4, 52], "copy_config_templ": [2, 3, 4, 32], "save_dir": [2, 3, 4, 32], "config_data": [2, 3, 4], "kei": [2, 3, 51], "dict_kei": [2, 3], "model_param": [2, 3], "dataset_param": [2, 3], "training_param": [2, 3], "visualizer_param": [2, 3], "abov": [2, 3], "separation_model": [2, 3], "class": [2, 3, 5, 6, 7, 8, 9, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 29, 30, 33, 38, 39, 40, 42, 44], "setup_model": 2, "set": [2, 4, 5, 7, 12, 14, 15, 19, 20, 21, 25, 27, 28], "up": [2, 4, 49], "its": [2, 4, 12, 17, 18, 19, 20, 29, 30, 50, 51, 52], "intern": [2, 4, 19, 20, 21], "If": [2, 4, 12, 13, 16, 29, 30, 32, 33, 46, 50], "mode": [2, 4, 19, 20], "state": [2, 4, 32, 51], "variou": [2, 4], "attribut": [2, 4, 12, 14, 15, 19, 20], "which": [2, 4, 50, 51, 52], "s": [2, 4, 5, 7, 20, 21, 22, 32, 50, 51], "underli": [2, 4, 19, 20], "network": [2, 4, 12, 16, 45, 50], "nn": [2, 4, 12, 17, 19, 20, 39, 40], "optim": [2, 4, 12, 15, 18, 19, 20, 32, 50], "learn": [2, 4, 19, 20, 21, 23, 45, 49], "rate": [2, 4, 5, 7, 8, 9, 10, 19, 20, 21, 29, 30, 49], "schedul": [2, 4, 19, 20, 32], "gradient": [2, 4, 19, 20, 21, 32, 33], "scaler": [2, 4, 32], "applic": [2, 4], "automat": [2, 4, 49], "mix": [2, 4, 20, 21, 49], "precis": [2, 4, 49], "misc": [2, 4], "otherwis": [2, 4, 19, 20], "best": [2, 4], "version": [2, 4, 46], "separ": [2, 4, 12, 13, 16, 19, 20, 21, 22, 25, 27, 28, 32, 40, 45, 50, 51, 52], "oserror": [2, 4, 32], "cannot": [2, 4, 5, 9, 10, 32], "filenotfounderror": [2, 4], "checkpoint": [2, 4, 32, 49, 51], "found": [2, 4], "directori": [2, 4, 5, 7, 8, 9, 10, 11, 32, 33, 51], "write": [2, 4, 33], "dictionari": [2, 4, 32], "check": [2, 4], "some": [2, 4, 50, 51], "have": [2, 4, 50], "been": [2, 4, 50, 52], "fill": [2, 4, 19, 20], "hasattr": [2, 4], "true": [2, 4, 5, 7, 8, 9, 10, 12, 15, 18, 20, 21, 29, 30, 32, 33, 52], "criterion": [2, 4, 12, 14, 19, 20, 49, 50], "modul": [4, 13, 14, 15, 19, 23, 39, 40], "i": [5, 12, 14, 17, 38, 50], "o": [5, 38], "object": [5, 7, 29, 30, 32, 33, 38, 50, 51], "audiodataset": [5, 8], "target": [5, 6, 7, 8, 9, 10, 11, 12, 13, 15, 16, 17, 18, 19, 20, 21, 33, 34, 35, 49, 50, 52], "chunk_siz": [5, 6, 8, 9], "3": [5, 6, 7, 12, 13, 16, 20, 21, 22, 24, 46], "num_chunk": [5, 6, 8], "10000": [5, 6, 8], "sample_r": [5, 6, 7, 8, 9, 10, 20, 21, 29, 30, 33], "full": [5, 6, 8, 10, 11, 45, 51, 52], "directli": [5, 6, 7, 10, 12, 15, 18, 19, 20], "memori": [5, 6, 7, 10, 49], "list": [5, 6, 7, 8, 9, 10, 11, 19, 20, 21, 29, 31, 49, 51], "str": [5, 6, 7, 8, 9, 10, 11, 12, 14, 19, 20, 21, 23, 29, 30, 32, 33, 34, 35, 49], "label": [5, 6, 8, 9, 10, 11, 19, 20, 21, 33, 34, 35, 52], "ground": [5, 6, 8, 9, 10, 12, 16, 18, 33, 34, 35], "truth": [5, 6, 8, 9, 10, 12, 16, 18, 33, 34, 35], "signal": [5, 6, 8, 9, 10, 12, 15, 18, 20, 21, 29, 30, 33, 35, 36], "int": [5, 6, 7, 8, 9, 10, 20, 21, 22, 23, 29, 30, 32, 33, 34, 35, 49], "each": [5, 6, 8, 9, 10, 11, 50, 51], "resampl": [5, 6, 8, 9, 10, 49], "chunk": [5, 6, 7, 8, 9, 49], "second": [5, 6, 8, 9, 20, 21, 49, 50], "default": [5, 6, 7, 8, 9, 10, 11, 12, 14, 20, 21, 22, 23, 29, 30, 32, 51], "2": [5, 6, 7, 8, 9, 12, 13, 14, 15, 16, 17, 18, 20, 21, 23, 49], "number": [5, 6, 7, 8, 10, 12, 14, 16, 17, 20, 21, 22, 23, 29, 30, 33, 34, 35, 49], "audiofold": [5, 9], "dataset_path": [5, 7, 8, 9, 10], "none": [5, 7, 8, 9, 10, 11, 20, 21, 23, 32, 33], "sample_length": [5, 7, 20, 21], "subset": [5, 7, 8, 9, 10, 11], "audio_format": [5, 7, 9], "wav": [5, 7, 9, 11, 52], "num_channel": [5, 7, 20, 21, 23], "1": [5, 7, 8, 12, 13, 14, 16, 17, 18, 20, 21, 22, 23, 33, 34, 35, 49, 50], "backend": [5, 7, 9], "soundfil": [5, 7, 9], "iterabledataset": [5, 7], "an": [5, 7, 8, 9, 12, 15, 18, 29, 30, 32, 45, 50, 51], "fly": [5, 7], "sampl": [5, 7, 8, 9, 10, 20, 21, 24, 29, 30, 33, 35, 49, 50], "gener": [5, 7, 20, 24, 33, 34, 35, 50], "design": [5, 7, 45], "effici": [5, 7, 45], "similar": [5, 7], "pytorch": [5, 7, 20, 40, 45], "imagefold": [5, 7], "from": [5, 7, 8, 9, 10, 19, 20, 22, 49, 50], "without": [5, 7, 19, 20, 50], "store": [5, 7, 12, 14, 15, 29, 30, 32, 33], "instead": [5, 7, 12], "ar": [5, 7, 33, 34, 35, 50], "randomli": [5, 7], "replac": [5, 7, 51], "dataload": [5, 7, 25, 27, 28], "root": [5, 7], "path": [5, 7, 8, 9, 10, 11, 32, 51], "vocal": [5, 7, 10, 11, 33, 34, 35, 45, 52], "The": [5, 7, 11, 12, 13, 14, 16, 17, 33, 34, 35, 50, 51], "format": [5, 7, 9], "channel": [5, 7, 20, 21, 23, 33, 34, 35, 49, 50], "torchaudio": [5, 7, 9], "generate_sampl": [5, 7], "helper": [5, 7, 8, 9], "method": [5, 7, 8, 9, 19, 20, 21, 22, 23, 24, 50, 52], "pair": [5, 7, 50, 51], "mixtur": [5, 6, 7, 10, 11, 12, 16, 19, 20, 21, 33, 50], "reinforce_typ": [5, 7], "expected_typ": [5, 7], "reinforc": [5, 7], "datapip": [5, 7], "And": [5, 7], "requir": [5, 7, 11, 19, 20, 50, 51], "subtyp": [5, 7], "origin": [5, 7, 50], "hint": [5, 7], "restrict": [5, 7], "split": [5, 7, 8, 9, 10, 45], "val_split": [5, 7], "0": [5, 7, 12, 13, 14, 16, 17, 20, 21, 22, 23, 50, 51, 52], "itself": [5, 7], "valid": [5, 7, 11, 19, 20, 25, 27, 28, 51], "float": [5, 7, 12, 13, 16, 17, 18, 19, 20, 21, 23, 49], "ratio": [5, 7, 12, 15], "off": [5, 7], "create_audio_dataset": 5, "max_num_track": [5, 8, 10], "100": [5, 8, 10, 52], "mono": [5, 8, 9, 10, 20, 23, 49], "belong": [5, 8, 9, 10, 11], "option": [5, 8, 9, 10, 11, 20, 21, 23, 32, 33, 51], "max": [5, 8, 10, 29, 30, 49, 52], "bool": [5, 8, 9, 10, 20, 21, 23, 29, 30, 32, 33, 49], "data_path": [5, 8, 9], "toy_dataset": [5, 8, 9], "test_dataset": [5, 8, 9], "1000": [5, 8], "22050": [5, 8, 9], "create_audio_fold": 5, "ioerror": [5, 9, 10, 11, 32], "verifi": [5, 9, 10, 11], "load_stem": 5, "A": [5, 10, 11, 19, 20, 36, 45, 48, 51], "order": [5, 10], "map": [5, 10, 33, 34, 50], "one": [5, 10, 12, 29, 31, 51], "where": [5, 10, 12, 13, 14, 15, 16, 17, 18, 20, 23, 32, 33, 34, 35, 50], "consist": [5, 10], "ndarrai": [5, 10, 29, 31], "bass": [5, 10, 11, 45], "drum": [5, 10, 11, 45], "other": [5, 10, 11, 12, 13, 16, 50], "background": [5, 10, 12, 16, 45], "ordereddict": [5, 10], "verify_dataset": 5, "subset_path": [5, 11], "structur": [5, 11, 51], "subdirectori": [5, 11], "must": [5, 11, 19, 20, 50], "meet": [5, 11], "follow": [5, 11, 19, 20, 29, 30], "rule": [5, 11], "end": [5, 11], "val": [5, 11, 20, 21], "contain": [5, 11, 51], "everi": [5, 11, 12], "individu": [5, 11], "titl": [5, 11], "within": [5, 11, 12, 32], "miss": [5, 11], "ani": [5, 11, 19, 20, 46, 51], "__getitem__": [6, 7], "idx": [6, 7], "get": [6, 12, 16, 17, 18, 33, 34, 35], "correspond": 6, "index": [6, 7, 45], "respect": [6, 7], "tupl": [6, 7], "name": [7, 49, 50, 52], "__iter__": 7, "yield": [7, 50], "function": [12, 17, 19, 20, 21, 37, 38, 39, 41, 42, 43, 44, 49, 50, 51], "integr": [12, 39], "componentloss": 12, "alpha": [12, 13, 16, 20, 23, 49], "beta": [12, 13, 16, 49], "8": [12, 13, 16], "wrapper": [12, 13, 14, 15, 20, 21, 29, 30], "component_loss": [12, 13, 49], "us": [12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 29, 30, 33, 45, 49, 50, 51, 52], "two": [12, 13, 16, 50], "three": [12, 13, 16], "compon": [12, 13, 16], "depend": [12, 13, 16], "argument": [12, 13, 16, 20, 22, 24, 51], "weigh": [12, 13, 16], "qualiti": [12, 13, 16, 45], "against": [12, 13, 16], "amount": [12, 13, 16], "residu": [12, 13, 16], "nois": [12, 13, 16, 50], "attenu": [12, 13, 16], "third": [12, 13, 16], "balanc": [12, 13, 16], "term": [12, 13, 14, 16, 17], "defin": [12, 13, 14, 15, 16, 17, 18, 50], "l_": [12, 13, 15, 16, 18], "2c": [12, 13, 16], "x": [12, 13, 16, 20, 24, 29, 30, 50], "y_": [12, 13, 16, 50], "k": [12, 13, 16, 50], "theta": [12, 13, 16, 50], "frac": [12, 13, 14, 15, 16, 17, 18, 29, 30], "n": [12, 13, 14, 16, 17, 20, 23], "f": [12, 13, 16, 20, 23, 33, 34, 50], "_2": [12, 13, 15, 16, 18], "r_f": [12, 13, 16], "3c": [12, 13, 16], "hat": [12, 13, 15, 16, 18, 50], "r": [12, 13, 16, 50], "m_": [12, 13, 16, 50], "odot": [12, 13, 16, 50], "filter": [12, 13, 16, 49], "r_": [12, 13, 16], "unit": [12, 13, 16], "spectrogrammaskmodel": [12, 13, 14, 15, 20], "spectrogram": [12, 13, 14, 15, 16, 17, 20, 21, 23, 24, 29, 30, 33, 34, 36, 51], "mask": [12, 13, 14, 15, 16, 20, 21, 22, 23, 49, 50], "valu": [12, 13, 16, 17, 18, 19, 20, 29, 30, 50, 51], "spectrogramnetva": [12, 13, 14, 17, 20, 52], "result": [12, 13, 45, 52], "kl_div_loss": [12, 13, 14], "ad": [12, 13], "forward": [12, 13, 14, 15, 19, 20, 21, 22, 23, 24], "calcul": [12, 13, 14, 15, 16, 17, 18, 19, 20, 50], "weight": [12, 13, 16, 33], "kldivergenceloss": 12, "loss_fn": [12, 14], "l1": [12, 14], "should": [12, 14, 19, 20], "kl": [12, 14, 17], "d_kl": [12, 14, 17], "p": [12, 14, 17, 20, 24, 49, 50], "q": [12, 14, 17], "distribut": [12, 14, 17, 20, 24], "standard": [12, 14, 17], "normal": [12, 14, 17, 20, 23, 29, 30, 49, 50], "In": [12, 14, 17, 50], "close": [12, 14, 17], "form": [12, 14, 17, 50], "can": [12, 14, 15, 17, 18, 45, 50, 51, 52], "express": [12, 14, 17], "d_": [12, 14, 17], "sum_": [12, 14, 17], "mu": [12, 14, 17], "sigma": [12, 14, 17], "ln": [12, 14, 17], "mean": [12, 14, 16, 17, 18, 50], "deviat": [12, 14, 17], "element": [12, 14, 16, 17, 50], "construct": [12, 14], "batch_loss": [12, 14, 15, 19, 20], "l1loss": 12, "l2loss": 12, "l2": 12, "l2maskloss": 12, "comput": [12, 17, 19, 20, 21, 29, 30], "perform": [12, 20, 21, 51], "call": [12, 19, 20, 33, 50, 51], "overridden": 12, "all": [12, 19, 20, 29, 31, 50], "subclass": [12, 19, 20], "although": [12, 50], "recip": 12, "pass": [12, 32, 51], "need": 12, "thi": [12, 50, 51], "afterward": 12, "sinc": 12, "former": 12, "take": 12, "care": 12, "regist": 12, "hook": 12, "while": 12, "latter": 12, "silent": [12, 49], "ignor": [12, 32], "them": 12, "rmseloss": 12, "rmse": 12, "sisdrloss": 12, "si_sdr_loss": [12, 15], "typic": [12, 15, 18], "For": [12, 15, 18], "text": [12, 15, 18], "si": [12, 15, 18], "sdr": [12, 15, 18], "y": [12, 15, 18, 29, 30, 50], "10": [12, 15, 18, 29, 30, 33, 50], "cdot": [12, 15, 50], "log_": [12, 15, 18, 29, 30], "proj_": [12, 15, 18], "estim": [12, 15, 16, 17, 18, 19, 20, 21, 22, 23, 33, 34, 35, 49, 50], "distort": [12, 15, 18], "combin": [12, 16, 17], "differ": [12, 16], "coeffici": [12, 16], "floattensor": [12, 16, 17, 18, 19, 20, 23], "soft": [12, 16, 20, 23, 49, 50], "output": [12, 16, 20, 21, 23, 33, 49], "between": [12, 16], "resiual": [12, 16], "torch": [12, 16, 17, 18, 33, 34, 35], "rand": [12, 16, 17, 18, 33, 34, 35], "16": [12, 16, 17, 18, 20, 21, 23], "512": [12, 16, 17, 20, 21, 33, 34], "173": [12, 16, 17, 33, 34], "scalar": [12, 16, 17, 18, 19, 20], "loss_val": [12, 16, 17, 18], "item": [12, 16, 17, 18], "get_evaluation_metr": 12, "16000": 12, "num_batch": 12, "batch": [12, 19, 20, 21, 23, 33, 34, 35, 49, 50, 52], "wise": [12, 19, 20, 21, 50], "eval": [12, 19, 20], "score": 12, "diverg": [12, 17], "onli": [12, 17, 20, 21], "std": [12, 17], "zero": [12, 17, 29, 30], "256": [12, 17], "ones": [12, 17], "estimate_spec": [12, 17, 33, 34], "target_spec": [12, 17, 33, 34], "div": [12, 17], "kl_term": [12, 17], "reconstruct": [12, 17], "l1_term": [12, 17], "l1_loss": [12, 17], "rmse_loss": 12, "ep": 12, "1e": 12, "06": 12, "scale": [12, 18, 20, 21, 29, 30], "invari": [12, 18], "domain": [12, 18, 20, 21, 29, 30, 50], "88200": [12, 18, 33, 35], "interfac": [19, 20], "share": [19, 20], "across": [19, 20], "rather": [19, 20, 50], "implement": [19, 20], "set_data": [19, 20, 21], "compute_loss": [19, 20, 21], "backward": [19, 20, 21], "optimizer_step": [19, 20, 21], "variabl": [19, 20, 24], "devic": [19, 20, 21, 23, 29, 30], "cuda": [19, 20], "avail": [19, 20], "cpu": [19, 20, 21, 29, 30, 49], "target_label": [19, 20, 21], "union": [19, 20, 29, 31], "callabl": [19, 20], "loss": [19, 20, 21, 36, 45, 49, 50], "lr": [19, 20, 21, 49, 52], "current": [19, 20, 21, 32, 46, 51], "train_loss": [19, 20], "epoch": [19, 20, 49, 52], "histori": [19, 20], "val_loss": [19, 20], "abstract": [19, 20], "backpropag": [19, 20, 21], "updat": [19, 20, 21], "process": [19, 20, 21, 49], "appropri": [19, 20], "input": [19, 20, 21, 23, 49, 50], "scheduler_step": [19, 20, 21], "decreas": [19, 20], "abc": 20, "base_model_typ": [20, 21], "num_fft": [20, 21, 29, 30], "1024": [20, 21, 22], "window_s": [20, 21, 29, 30], "hop_length": [20, 21, 29, 30], "num_hidden_channel": [20, 21], "mask_act_fn": [20, 21, 23], "sigmoid": [20, 21, 23], "leak_factor": [20, 21, 23], "dropout_p": [20, 21, 23, 51], "4": [20, 21, 51], "normalize_input": [20, 21, 23], "normalize_output": [20, 21, 23], "deep": [20, 21, 22, 23, 45], "architectur": [20, 21, 45, 49], "fft": [20, 21, 23, 29, 30, 49], "bin": [20, 21, 23, 29, 30, 33, 34, 49], "note": [20, 21, 33, 34, 36, 50, 52], "due": [20, 21], "symmetri": [20, 21], "window": [20, 21, 29, 30, 49, 50], "size": [20, 21, 23, 29, 30, 49, 52], "hop": [20, 21, 29, 30, 49], "length": [20, 21, 29, 30, 49], "initi": [20, 21, 23, 33, 49, 51, 52], "hidden": [20, 21, 22, 49], "activ": [20, 21, 23, 49], "leak": [20, 21, 49], "factor": [20, 21, 49, 50], "leaky_relu": [20, 21, 49], "layer": [20, 21, 22, 23, 49], "dropout": [20, 21, 23, 49], "probabl": [20, 21, 23, 49], "whether": [20, 21, 22, 23, 32], "center": [20, 21], "appli": [20, 21, 50], "reduc": [20, 21, 49], "improv": [20, 21], "earli": [20, 21, 49], "stop": [20, 21, 49], "transform": [20, 21, 36, 45], "access": [20, 21], "spectrogramnetlstm": [20, 24], "arg": [20, 22, 24], "recurrent_depth": [20, 22], "hidden_s": [20, 22], "input_axi": [20, 22], "kwarg": [20, 22, 24], "spectrogramnetsimpl": [20, 22, 51], "lstm": [20, 22, 24], "bottleneck": [20, 22, 24], "stack": [20, 22, 33, 34], "featur": [20, 22, 23, 45, 51], "feed": [20, 22, 24, 50], "dim": [20, 22], "frequenc": [20, 22, 23, 29, 30, 33, 34, 50], "axi": [20, 22, 23, 33, 34, 35], "time": [20, 22, 23, 29, 30, 33, 34, 35, 36], "keyword": [20, 22, 24, 51], "posit": [20, 22, 24], "constructor": [20, 22, 24], "addit": [20, 22, 24, 50], "split_lstm_paramet": [20, 22], "non": [20, 22, 33, 34, 35], "num_fft_bin": [20, 23], "num_fram": [20, 23], "hidden_channel": [20, 23], "5": [20, 23], "fals": [20, 23, 33], "vanilla": [20, 23], "aka": [20, 23, 49, 50], "filterbank": [20, 23, 49, 50], "tempor": [20, 23], "stereo": [20, 23, 49], "final": [20, 23], "multipl": [20, 23, 29, 30, 50], "constant": [20, 23, 49], "leaki": [20, 23], "relu": [20, 23, 51], "shape": [20, 23, 33, 34, 35], "c": [20, 23, 33, 34, 35, 50], "t": [20, 23, 33, 34, 35, 50], "frame": [20, 23, 33, 34], "u": [20, 24], "net": [20, 24], "vae": [20, 24], "encod": [20, 24], "decod": [20, 24], "gaussian": [20, 24], "condit": [20, 24], "z": [20, 24], "latent": [20, 24], "run_train": 25, "train_dataload": [25, 27], "val_dataload": [25, 27, 28], "callback": [25, 27], "loop": [25, 27, 28], "trainingcallback": [25, 27], "run_valid": 25, "audiotransform": 29, "conveni": [29, 30, 51], "tool": [29, 30, 45], "audio_to_mel": [29, 30], "to_db": [29, 30], "raw": [29, 30], "mel": [29, 30], "to_spectrogram": [29, 30], "to_mel_scal": [29, 30], "subroutin": [29, 30], "convert": [29, 30], "magnitud": [29, 30, 50], "decibel": [29, 30], "first": [29, 30, 51, 52], "pad_audio": [29, 30], "make": [29, 30, 50], "divis": [29, 30], "tenor": [29, 30], "to_audio": [29, 30], "complex_spec": [29, 30], "complex": [29, 30, 50], "to_decibel": [29, 30], "math": [29, 30], "mul": [29, 30], "log": [29, 30, 33, 49, 51], "use_pad": [29, 30], "represent": [29, 30, 36], "trim_audio": 29, "audio_tensor": [29, 31], "trim": [29, 31], "match": [29, 31], "shortest": [29, 31], "arrai": [29, 31, 45], "clone": 32, "config": [32, 33, 52], "json": [32, 51], "copi": 32, "work": [32, 50], "expect": [32, 46], "param": 32, "load_object": 32, "obj_nam": 32, "global_step": [32, 33], "attach": 32, "global": 32, "step": [32, 49], "save_al": 32, "save_model": 32, "save_optim": 32, "save_schedul": 32, "save_grad_scal": 32, "e": [32, 50], "g": [32, 51], "gradient_scal": 32, "save_config": 32, "filepath": 32, "save_object": 32, "pth": 32, "under": [32, 33], "trainingvisu": 33, "output_dir": 33, "writer": 33, "view_spectrogram": 33, "view_waveform": 33, "view_gradi": 33, "play_audio": 33, "num_imag": 33, "save_imag": 33, "save_audio": 33, "interv": 33, "monitor": 33, "through": [33, 52], "imag": [33, 50, 51], "playback": 33, "especi": 33, "tensorboard": [33, 51], "summarywrit": 33, "outer_dir": 33, "outer": 33, "show_spec_diff": 33, "figur": [33, 34, 35], "show_waveform_diff": 33, "embed_audio": 33, "visualize_gradi": 33, "send": 33, "visualize_spectrogram": 33, "visualize_waveform": 33, "waveform": [33, 35, 51], "config_visu": 33, "spec_show_diff": [33, 35], "resolut": [33, 34, 35], "120": [33, 34, 35], "pyplot": [33, 34, 35], "compar": [33, 34, 35], "subfigur": [33, 34], "vertic": [33, 34, 35], "horizont": [33, 34, 35], "amplitud": [33, 34, 35, 50], "intens": [33, 34], "color": [33, 34], "averag": [33, 34, 35], "collaps": [33, 34, 35], "dpi": [33, 34, 35], "matplotlib": [33, 34, 35], "plt": [33, 34, 35], "fig": [33, 34, 35], "displai": [33, 34, 35, 51], "show": [33, 34, 35], "savefig": [33, 34, 35], "fname": [33, 34, 35], "spec_comparison": [33, 34], "png": [33, 34, 35], "waveform_show_diff": 33, "overlai": [33, 35], "togeth": [33, 35], "like": [33, 35, 51], "estimate_audio": [33, 35], "target_audio": [33, 35], "waveform_comparison": [33, 35], "shallow": [36, 45, 48], "dive": [36, 45, 48], "theori": [36, 45, 48], "definit": [36, 48], "short": 36, "fourier": 36, "basic": [36, 45], "usag": [36, 45], "pretrain": [36, 45], "custom": [36, 45], "python": [36, 45, 46], "api": [36, 52], "auralflow": [36, 46, 51, 52], "dataset": [36, 45, 51], "trainer": [36, 45], "visual": [36, 45, 51], "lightweight": 45, "toolkit": 45, "music": [45, 50], "minim": [45, 50], "code": 45, "With": 45, "highli": 45, "customiz": [45, 51], "processor": 45, "offer": 45, "seamless": 45, "ml": 45, "workflow": 45, "moreov": [45, 50, 51], "entir": 45, "nativ": 45, "packag": [45, 46, 51], "port": 45, "more": [45, 51], "versatil": 45, "lastli": [45, 52], "sport": 45, "download": [45, 50, 52], "neural": 45, "instrument": 45, "instal": 45, "tutori": 45, "7": 46, "11": 46, "support": 46, "lower": 46, "futur": 46, "via": [46, 51], "pypi": 46, "manag": 46, "pip": 46, "latest": 46, "upgrad": 46, "you": [46, 51], "encount": 46, "troubl": 46, "pleas": [46, 50], "issu": 46, "github": 46, "here": [46, 51], "learnabl": 49, "num": 49, "pool": 49, "stft": [49, 50], "patienc": 49, "befor": 49, "reduct": 49, "worker": 49, "pin": 49, "speed": 49, "transfer": 49, "gpu": 49, "suppress": 49, "messag": 49, "section": 50, "aim": 50, "simplifi": 50, "topic": 50, "analysi": 50, "gain": 50, "better": 50, "intuit": 50, "rigor": 50, "treatment": 50, "refer": 50, "proper": 50, "proof": 50, "There": 50, "let": 50, "mathbb": 50, "record": 50, "almost": 50, "univers": 50, "repres": 50, "convent": 50, "often": 50, "a_i": 50, "foral": 50, "tau": 50, "thought": 50, "kind": 50, "project": 50, "onto": 50, "higher": 50, "dimension": 50, "space": 50, "introduc": 50, "inform": 50, "also": 50, "we": [50, 51], "treat": 50, "blackbox": 50, "linear": 50, "codomain": 50, "invers": 50, "back": 50, "As": 50, "wa": 50, "allud": 50, "introduct": 50, "uncertainti": 50, "ensur": 50, "huge": 50, "neq": 50, "howev": 50, "carefulli": 50, "choos": 50, "good": 50, "unknown": 50, "e_": 50, "approx": 50, "go": 50, "much": 50, "detail": 50, "approxim": 50, "algorithm": 50, "discret": 50, "dft": 50, "parameter": 50, "small": 50, "overlap": 50, "segment": 50, "disclaim": 50, "ha": [50, 52], "trivial": 50, "extend": 50, "dimens": 50, "part": 50, "canon": 50, "phase": 50, "_": 50, "angl": 50, "entri": 50, "our": 50, "emploi": 50, "trick": 50, "describ": 50, "next": [50, 51, 52], "task": 50, "simpler": 50, "To": [50, 51, 52], "mini": 50, "s_": 50, "hadamard": 50, "product": 50, "y_k": 50, "l": 50, "find": 50, "choic": 50, "argmin_": 50, "recent": 50, "literatur": 50, "most": 50, "common": 50, "absolut": 50, "squar": 50, "error": 50, "mse": 50, "sgd": 50, "adam": 50, "prior": 50, "knowledg": 50, "mai": 50, "clear": 50, "how": 50, "inde": 50, "shine": 50, "avoid": 50, "predica": 50, "altogeth": 50, "known": 50, "complic": 50, "wai": [50, 51], "griffin": 50, "lim": 50, "http": 50, "citeseerx": 50, "ist": 50, "psu": 50, "edu": 50, "viewdoc": 50, "doi": 50, "306": 50, "7858": 50, "rep": 50, "rep1": 50, "pdf": 50, "mention": 50, "earlier": 50, "quick": 50, "dirti": 50, "pretti": 50, "well": 50, "put": 50, "simpli": [50, 51], "correct": 50, "bar": 50, "rm": 50, "exp": 50, "j": 50, "imaginari": 50, "last": 50, "necessari": [50, 51], "transport": 50, "\u03f5": 50, "overfit": 50, "ve": 50, "solv": 50, "sound": 50, "ear": 50, "simplest": 51, "invok": [51, 52], "four": 51, "shell": 51, "cover": 51, "essenti": 51, "presenc": 51, "certain": 51, "organ": 51, "when": 51, "scratch": 51, "seen": 51, "below": 51, "your_model": 51, "content": 51, "cv": 51, "clip": 51, "plot": 51, "extrem": 51, "simpl": 51, "encapsul": 51, "insid": 51, "start": 51, "templat": 51, "so": 51, "far": 51, "look": 51, "relat": 51, "achiev": [51, 52], "edit": 51, "modern": 51, "id": 51, "open": 51, "desir": 51, "parameter_group": 51, "parameter_nam": 51, "new_valu": 51, "confi": 51, "mask_activ": 51, "spec_net_va": 52, "onc": 52, "ai": 52, "jame": 52, "schoolboi": 52, "fascin": 52, "musdb18": 52, "001": 52, "32": 52, "everyth": 52, "done": 52, "command": 52, "line": 52, "revers": 52}, "objects": {"": [[1, 0, 0, "-", "auralflow"]], "auralflow": [[37, 0, 0, "-", "customs"], [38, 0, 0, "-", "datasets"], [39, 0, 0, "-", "losses"], [40, 0, 0, "-", "models"], [1, 0, 0, "-", "separate"], [1, 0, 0, "-", "test"], [1, 0, 0, "-", "train"], [41, 0, 0, "-", "trainer"], [42, 0, 0, "-", "transforms"], [43, 0, 0, "-", "utils"], [44, 0, 0, "-", "visualizer"]], "auralflow.customs": [[3, 1, 1, "", "init_model"], [4, 1, 1, "", "setup_model"]], "auralflow.datasets": [[6, 2, 1, "", "AudioDataset"], [7, 2, 1, "", "AudioFolder"], [8, 1, 1, "", "create_audio_dataset"], [9, 1, 1, "", "create_audio_folder"], [10, 1, 1, "", "load_stems"], [11, 1, 1, "", "verify_dataset"]], "auralflow.datasets.AudioDataset": [[6, 3, 1, "", "__getitem__"]], "auralflow.datasets.AudioFolder": [[7, 3, 1, "", "__getitem__"], [7, 3, 1, "", "__iter__"], [7, 3, 1, "", "generate_sample"], [7, 3, 1, "", "reinforce_type"], [7, 3, 1, "", "split"]], "auralflow.losses": [[13, 2, 1, "", "ComponentLoss"], [14, 2, 1, "", "KLDivergenceLoss"], [12, 2, 1, "", "L1Loss"], [12, 2, 1, "", "L2Loss"], [12, 2, 1, "", "L2MaskLoss"], [12, 2, 1, "", "RMSELoss"], [15, 2, 1, "", "SISDRLoss"], [16, 1, 1, "", "component_loss"], [12, 1, 1, "", "get_evaluation_metrics"], [17, 1, 1, "", "kl_div_loss"], [12, 1, 1, "", "rmse_loss"], [18, 1, 1, "", "si_sdr_loss"]], "auralflow.losses.ComponentLoss": [[13, 3, 1, "", "forward"]], "auralflow.losses.KLDivergenceLoss": [[14, 3, 1, "", "forward"]], "auralflow.losses.L1Loss": [[12, 3, 1, "", "forward"]], "auralflow.losses.L2Loss": [[12, 3, 1, "", "forward"]], "auralflow.losses.L2MaskLoss": [[12, 3, 1, "", "forward"]], "auralflow.losses.RMSELoss": [[12, 3, 1, "", "forward"]], "auralflow.losses.SISDRLoss": [[15, 3, 1, "", "forward"]], "auralflow.models": [[20, 2, 1, "", "SeparationModel"], [21, 2, 1, "", "SpectrogramMaskModel"], [22, 2, 1, "", "SpectrogramNetLSTM"], [23, 2, 1, "", "SpectrogramNetSimple"], [24, 2, 1, "", "SpectrogramNetVAE"]], "auralflow.models.SeparationModel": [[20, 3, 1, "", "backward"], [20, 3, 1, "", "compute_loss"], [20, 3, 1, "", "eval"], [20, 3, 1, "", "forward"], [20, 3, 1, "", "optimizer_step"], [20, 3, 1, "", "scheduler_step"], [20, 3, 1, "", "separate"], [20, 3, 1, "", "set_data"], [20, 3, 1, "", "test"], [20, 3, 1, "", "train"]], "auralflow.models.SpectrogramMaskModel": [[21, 3, 1, "", "backward"], [21, 3, 1, "", "compute_loss"], [21, 3, 1, "", "forward"], [21, 3, 1, "", "optimizer_step"], [21, 3, 1, "", "scheduler_step"], [21, 3, 1, "", "separate"], [21, 3, 1, "", "set_data"]], "auralflow.models.SpectrogramNetLSTM": [[22, 3, 1, "", "forward"], [22, 3, 1, "", "split_lstm_parameters"]], "auralflow.models.SpectrogramNetSimple": [[23, 3, 1, "", "forward"]], "auralflow.models.SpectrogramNetVAE": [[24, 3, 1, "", "forward"]], "auralflow.separate": [[1, 1, 1, "", "separate_audio"]], "auralflow.test": [[1, 1, 1, "", "main"]], "auralflow.train": [[1, 1, 1, "", "main"]], "auralflow.trainer": [[26, 1, 1, "", "callbacks"], [27, 1, 1, "", "run_training"], [28, 1, 1, "", "run_validation"]], "auralflow.transforms": [[30, 2, 1, "", "AudioTransform"], [31, 1, 1, "", "trim_audio"]], "auralflow.transforms.AudioTransform": [[30, 3, 1, "", "audio_to_mel"], [30, 3, 1, "", "pad_audio"], [30, 3, 1, "", "to_audio"], [30, 3, 1, "", "to_decibel"], [30, 3, 1, "", "to_mel_scale"], [30, 3, 1, "", "to_spectrogram"]], "auralflow.utils": [[32, 1, 1, "", "copy_config_template"], [32, 1, 1, "", "load_config"], [32, 1, 1, "", "load_object"], [32, 1, 1, "", "save_all"], [32, 1, 1, "", "save_config"], [32, 1, 1, "", "save_object"]], "auralflow.visualizer": [[33, 2, 1, "", "TrainingVisualizer"], [33, 1, 1, "", "config_visualizer"], [34, 1, 1, "", "spec_show_diff"], [35, 1, 1, "", "waveform_show_diff"]], "auralflow.visualizer.TrainingVisualizer": [[33, 3, 1, "", "embed_audio"], [33, 3, 1, "", "visualize"], [33, 3, 1, "", "visualize_gradient"], [33, 3, 1, "", "visualize_spectrogram"], [33, 3, 1, "", "visualize_waveform"]]}, "objtypes": {"0": "py:module", "1": "py:function", "2": "py:class", "3": "py:method"}, "objnames": {"0": ["py", "module", "Python module"], "1": ["py", "function", "Python function"], "2": ["py", "class", "Python class"], "3": ["py", "method", "Python method"]}, "titleterms": {"python": 0, "api": [0, 45], "auralflow": [1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 37, 38, 39, 40, 41, 42, 43, 44, 45, 47], "packag": 1, "subpackag": 1, "separ": 1, "modul": [1, 2, 5, 12, 20, 25, 29, 32, 33], "test": 1, "train": [1, 49], "content": [1, 2, 5, 12, 20, 25, 29, 32, 33], "custom": [2, 3, 4, 37, 52], "init_model": 3, "setup_model": 4, "dataset": [5, 6, 7, 8, 9, 10, 11, 38, 49], "audiodataset": 6, "audiofold": 7, "create_audio_dataset": 8, "create_audio_fold": 9, "load_stem": 10, "verify_dataset": 11, "loss": [12, 13, 14, 15, 16, 17, 18, 39], "componentloss": 13, "kldivergenceloss": 14, "sisdrloss": 15, "component_loss": 16, "kl_div_loss": 17, "si_sdr_loss": 18, "model": [19, 20, 21, 22, 23, 24, 40, 49, 51, 52], "separationmodel": 19, "spectrogrammaskmodel": 21, "spectrogramnetlstm": 22, "spectrogramnetsimpl": 23, "spectrogramnetva": 24, "trainer": [25, 26, 27, 28, 41], "callback": 26, "run_train": 27, "run_valid": 28, "transform": [29, 30, 31, 42, 50], "audiotransform": 30, "trim_audio": 31, "util": [32, 43], "visual": [33, 34, 35, 44], "spec_show_diff": 34, "waveform_show_diff": 35, "document": 45, "quickstart": 45, "note": [45, 48], "refer": 45, "indic": 45, "tabl": 45, "instal": 46, "system": 46, "requir": 46, "updat": 46, "paramet": [49, 51], "A": 50, "shallow": 50, "dive": 50, "theori": 50, "definit": 50, "audio": 50, "represent": 50, "signal": 50, "spectrogram": 50, "short": 50, "time": 50, "fourier": 50, "tutori": 51, "configur": 51, "config": 51, "set": 51, "modifi": 51, "within": 51, "text": 51, "editor": 51, "recommend": 51, "from": 51, "command": 51, "line": 51, "basic": 52, "usag": 52, "pretrain": 52}, "envversion": {"sphinx.domains.c": 2, "sphinx.domains.changeset": 1, "sphinx.domains.citation": 1, "sphinx.domains.cpp": 6, "sphinx.domains.index": 1, "sphinx.domains.javascript": 2, "sphinx.domains.math": 2, "sphinx.domains.python": 3, "sphinx.domains.rst": 2, "sphinx.domains.std": 2, "sphinx.ext.viewcode": 1, "sphinx": 56}})